
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://MarkinHaus.github.io/ToolBoxV2/isaa/">
      
      
        <link rel="prev" href="../utils/">
      
      
        <link rel="next" href="../agent/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>isaa - ToolBoxV2 Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#isaa-intelligent-system-agent-architecture-documentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ToolBoxV2 Docs" class="md-header__button md-logo" aria-label="ToolBoxV2 Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ToolBoxV2 Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              isaa
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/MarkinHaus/ToolBoxV2" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    ToolBoxV2
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ToolBoxV2 Docs" class="md-nav__button md-logo" aria-label="ToolBoxV2 Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    ToolBoxV2 Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/MarkinHaus/ToolBoxV2" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    ToolBoxV2
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../module_creation_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tbjs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TBjs
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../clis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CLIS
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/MarkinHaus/ToolBoxV2/issues" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Report Issues
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" checked>
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../toolboxv2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    toolboxv2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    isaa
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    isaa
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-overview" class="md-nav__link">
    <span class="md-ellipsis">
      1. Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-core-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      2. Core Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Core Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-flowagent" class="md-nav__link">
    <span class="md-ellipsis">
      2.1. FlowAgent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-flowagentbuilder" class="md-nav__link">
    <span class="md-ellipsis">
      2.2. FlowAgentBuilder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-toolsinterface" class="md-nav__link">
    <span class="md-ellipsis">
      2.3. ToolsInterface
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-aisemanticmemory" class="md-nav__link">
    <span class="md-ellipsis">
      2.4. AISemanticMemory
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-initialization-and-configuration-tools-class" class="md-nav__link">
    <span class="md-ellipsis">
      3. Initialization and Configuration (Tools Class)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Initialization and Configuration (Tools Class)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#isaaon_exit" class="md-nav__link">
    <span class="md-ellipsis">
      isaa.on_exit()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-agent-management" class="md-nav__link">
    <span class="md-ellipsis">
      4. Agent Management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Agent Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-getting-an-agent-builder-get_agent_builder" class="md-nav__link">
    <span class="md-ellipsis">
      4.1. Getting an Agent Builder (get_agent_builder)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-registering-an-agent-async-register_agent" class="md-nav__link">
    <span class="md-ellipsis">
      4.2. Registering an Agent (async register_agent)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-retrieving-an-agent-instance-async-get_agent" class="md-nav__link">
    <span class="md-ellipsis">
      4.3. Retrieving an Agent Instance (async get_agent)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-running-agents-and-tasks" class="md-nav__link">
    <span class="md-ellipsis">
      5. Running Agents and Tasks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Running Agents and Tasks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-running-an-agent-async-run_agent" class="md-nav__link">
    <span class="md-ellipsis">
      5.1. Running an Agent (async run_agent)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-structured-output-async-format_class" class="md-nav__link">
    <span class="md-ellipsis">
      5.2. Structured Output (async format_class)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-code-execution-with-toolsinterface" class="md-nav__link">
    <span class="md-ellipsis">
      6. Code Execution with ToolsInterface
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-semantic-memory-aisemanticmemory" class="md-nav__link">
    <span class="md-ellipsis">
      7. Semantic Memory (AISemanticMemory)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-tool-integration" class="md-nav__link">
    <span class="md-ellipsis">
      8. Tool Integration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="8. Tool Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default-isaa-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Default ISAA Tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-your-own-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Adding Your Own Tools
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-example-usage-flow" class="md-nav__link">
    <span class="md-ellipsis">
      9. Example Usage Flow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-important-notes" class="md-nav__link">
    <span class="md-ellipsis">
      10. Important Notes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Core Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-basic-chain-operations" class="md-nav__link">
    <span class="md-ellipsis">
      1. Basic Chain Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-chain-components" class="md-nav__link">
    <span class="md-ellipsis">
      2. Chain Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Chain Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cf-chain-format" class="md-nav__link">
    <span class="md-ellipsis">
      CF (Chain Format)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is-conditional-check" class="md-nav__link">
    <span class="md-ellipsis">
      IS (Conditional Check)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Basic Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-setting-up-agents-for-chaining" class="md-nav__link">
    <span class="md-ellipsis">
      1. Setting Up Agents for Chaining
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-simple-sequential-chain" class="md-nav__link">
    <span class="md-ellipsis">
      2. Simple Sequential Chain
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-chain-features" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Chain Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Chain Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-data-formatting-with-cf" class="md-nav__link">
    <span class="md-ellipsis">
      1. Data Formatting with CF
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-data-extraction-with-key-selection" class="md-nav__link">
    <span class="md-ellipsis">
      2. Data Extraction with Key Selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-parallel-processing" class="md-nav__link">
    <span class="md-ellipsis">
      3. Parallel Processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-auto-parallel-processing" class="md-nav__link">
    <span class="md-ellipsis">
      4. Auto-Parallel Processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-conditional-chains" class="md-nav__link">
    <span class="md-ellipsis">
      5. Conditional Chains
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-error-handling-chains" class="md-nav__link">
    <span class="md-ellipsis">
      6. Error Handling Chains
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#complex-workflow-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Complex Workflow Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Complex Workflow Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-multi-stage-document-processing" class="md-nav__link">
    <span class="md-ellipsis">
      1. Multi-Stage Document Processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-customer-service-chain" class="md-nav__link">
    <span class="md-ellipsis">
      2. Customer Service Chain
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chain-visualization-and-debugging" class="md-nav__link">
    <span class="md-ellipsis">
      Chain Visualization and Debugging
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Chain Visualization and Debugging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-visualize-chain-structure" class="md-nav__link">
    <span class="md-ellipsis">
      1. Visualize Chain Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-progress-tracking" class="md-nav__link">
    <span class="md-ellipsis">
      2. Progress Tracking
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-agent-specialization" class="md-nav__link">
    <span class="md-ellipsis">
      1. Agent Specialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-error-recovery-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      2. Error Recovery Patterns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-performance-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      3. Performance Optimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#direckt-call-support" class="md-nav__link">
    <span class="md-ellipsis">
      Direckt call Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chain-operators-reference" class="md-nav__link">
    <span class="md-ellipsis">
      Chain Operators Reference
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cf-chain-format-reference" class="md-nav__link">
    <span class="md-ellipsis">
      CF (Chain Format) Reference
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    isaa_help
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    etc
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            etc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../account_management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    account_management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    changelog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../db_usage_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    db_usage_guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../p2p_rpc_protocol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    p2p_rpc_protocol
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    stack
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-overview" class="md-nav__link">
    <span class="md-ellipsis">
      1. Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-core-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      2. Core Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Core Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-flowagent" class="md-nav__link">
    <span class="md-ellipsis">
      2.1. FlowAgent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-flowagentbuilder" class="md-nav__link">
    <span class="md-ellipsis">
      2.2. FlowAgentBuilder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-toolsinterface" class="md-nav__link">
    <span class="md-ellipsis">
      2.3. ToolsInterface
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-aisemanticmemory" class="md-nav__link">
    <span class="md-ellipsis">
      2.4. AISemanticMemory
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-initialization-and-configuration-tools-class" class="md-nav__link">
    <span class="md-ellipsis">
      3. Initialization and Configuration (Tools Class)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Initialization and Configuration (Tools Class)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#isaaon_exit" class="md-nav__link">
    <span class="md-ellipsis">
      isaa.on_exit()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-agent-management" class="md-nav__link">
    <span class="md-ellipsis">
      4. Agent Management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Agent Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-getting-an-agent-builder-get_agent_builder" class="md-nav__link">
    <span class="md-ellipsis">
      4.1. Getting an Agent Builder (get_agent_builder)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-registering-an-agent-async-register_agent" class="md-nav__link">
    <span class="md-ellipsis">
      4.2. Registering an Agent (async register_agent)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-retrieving-an-agent-instance-async-get_agent" class="md-nav__link">
    <span class="md-ellipsis">
      4.3. Retrieving an Agent Instance (async get_agent)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-running-agents-and-tasks" class="md-nav__link">
    <span class="md-ellipsis">
      5. Running Agents and Tasks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Running Agents and Tasks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-running-an-agent-async-run_agent" class="md-nav__link">
    <span class="md-ellipsis">
      5.1. Running an Agent (async run_agent)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-structured-output-async-format_class" class="md-nav__link">
    <span class="md-ellipsis">
      5.2. Structured Output (async format_class)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-code-execution-with-toolsinterface" class="md-nav__link">
    <span class="md-ellipsis">
      6. Code Execution with ToolsInterface
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-semantic-memory-aisemanticmemory" class="md-nav__link">
    <span class="md-ellipsis">
      7. Semantic Memory (AISemanticMemory)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-tool-integration" class="md-nav__link">
    <span class="md-ellipsis">
      8. Tool Integration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="8. Tool Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default-isaa-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Default ISAA Tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-your-own-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Adding Your Own Tools
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-example-usage-flow" class="md-nav__link">
    <span class="md-ellipsis">
      9. Example Usage Flow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-important-notes" class="md-nav__link">
    <span class="md-ellipsis">
      10. Important Notes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Core Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-basic-chain-operations" class="md-nav__link">
    <span class="md-ellipsis">
      1. Basic Chain Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-chain-components" class="md-nav__link">
    <span class="md-ellipsis">
      2. Chain Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Chain Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cf-chain-format" class="md-nav__link">
    <span class="md-ellipsis">
      CF (Chain Format)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is-conditional-check" class="md-nav__link">
    <span class="md-ellipsis">
      IS (Conditional Check)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Basic Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-setting-up-agents-for-chaining" class="md-nav__link">
    <span class="md-ellipsis">
      1. Setting Up Agents for Chaining
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-simple-sequential-chain" class="md-nav__link">
    <span class="md-ellipsis">
      2. Simple Sequential Chain
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-chain-features" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Chain Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Chain Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-data-formatting-with-cf" class="md-nav__link">
    <span class="md-ellipsis">
      1. Data Formatting with CF
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-data-extraction-with-key-selection" class="md-nav__link">
    <span class="md-ellipsis">
      2. Data Extraction with Key Selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-parallel-processing" class="md-nav__link">
    <span class="md-ellipsis">
      3. Parallel Processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-auto-parallel-processing" class="md-nav__link">
    <span class="md-ellipsis">
      4. Auto-Parallel Processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-conditional-chains" class="md-nav__link">
    <span class="md-ellipsis">
      5. Conditional Chains
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-error-handling-chains" class="md-nav__link">
    <span class="md-ellipsis">
      6. Error Handling Chains
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#complex-workflow-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Complex Workflow Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Complex Workflow Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-multi-stage-document-processing" class="md-nav__link">
    <span class="md-ellipsis">
      1. Multi-Stage Document Processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-customer-service-chain" class="md-nav__link">
    <span class="md-ellipsis">
      2. Customer Service Chain
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chain-visualization-and-debugging" class="md-nav__link">
    <span class="md-ellipsis">
      Chain Visualization and Debugging
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Chain Visualization and Debugging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-visualize-chain-structure" class="md-nav__link">
    <span class="md-ellipsis">
      1. Visualize Chain Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-progress-tracking" class="md-nav__link">
    <span class="md-ellipsis">
      2. Progress Tracking
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-agent-specialization" class="md-nav__link">
    <span class="md-ellipsis">
      1. Agent Specialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-error-recovery-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      2. Error Recovery Patterns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-performance-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      3. Performance Optimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#direckt-call-support" class="md-nav__link">
    <span class="md-ellipsis">
      Direckt call Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chain-operators-reference" class="md-nav__link">
    <span class="md-ellipsis">
      Chain Operators Reference
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cf-chain-format-reference" class="md-nav__link">
    <span class="md-ellipsis">
      CF (Chain Format) Reference
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                



                  


  
  


<h1 id="isaa-intelligent-system-agent-architecture-documentation">ISAA (Intelligent System Agent Architecture) Documentation<a class="headerlink" href="#isaa-intelligent-system-agent-architecture-documentation" title="Permanent link">&para;</a></h1>
<h2 id="1-overview">1. Overview<a class="headerlink" href="#1-overview" title="Permanent link">&para;</a></h2>
<p>The ISAA (Intelligent System Agent Architecture) module is a sophisticated framework for building, configuring, and orchestrating advanced AI agents. At its core, ISAA now leverages the powerful <strong><code>FlowAgent</code></strong>, a next-generation agent designed for complex reasoning, dynamic planning, and robust tool use.</p>
<p>The module provides a high-level API to manage the lifecycle of these agents, from creation and configuration to execution and state management. It is built for asynchronous operations, ensuring high performance in complex, multi-agent workflows.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li><strong>Advanced Agent Core</strong>: Powered by the new <strong><a href="../agent/">FlowAgent</a></strong>, which features an outline-driven reasoning loop, sub-system orchestration, and auto-recovery.</li>
<li><strong>Builder-Centric Configuration</strong>: Uses the <code>FlowAgentBuilder</code> for a fluent, declarative, and serializable approach to agent setup.</li>
<li><strong>Stateful Code &amp; File Execution</strong>: Each agent is equipped with a <code>ToolsInterface</code>, providing a sandboxed environment for code execution, file system operations, and web browsing.</li>
<li><strong>Semantic Memory</strong>: Integrates with <code>AISemanticMemory</code> for long-term, persistent knowledge storage and retrieval.</li>
<li><strong>Unified Tool System</strong>: Seamlessly integrates custom functions, core ISAA utilities, and agent-specific <code>ToolsInterface</code> capabilities.</li>
<li><strong>Asynchronous by Design</strong>: All primary operations are <code>async</code>, making the system scalable and efficient.</li>
</ul>
<h2 id="2-core-concepts">2. Core Concepts<a class="headerlink" href="#2-core-concepts" title="Permanent link">&para;</a></h2>
<h3 id="21-flowagent">2.1. <code>FlowAgent</code><a class="headerlink" href="#21-flowagent" title="Permanent link">&para;</a></h3>
<p>The <code>FlowAgent</code> is the heart of the ISAA module. It's a highly advanced agent capable of autonomous reasoning and complex task execution.</p>
<p>For a comprehensive guide on the internal architecture, capabilities, and API of the <code>FlowAgent</code> itself, please refer to the <strong><a href="../agent/">FlowAgent Documentation</a></strong>.</p>
<p>Key characteristics relevant to ISAA include:</p>
<ul>
<li><strong>Reasoning Core:</strong> Makes strategic decisions instead of following rigid plans.</li>
<li><strong>Unified Context:</strong> Manages conversation history, task status, and variables through a <code>UnifiedContextManager</code>.</li>
<li><strong>Dynamic Tool Use:</strong> Intelligently analyzes and selects tools based on the immediate context.</li>
<li><strong>State Management:</strong> Utilizes a powerful, scoped <code>VariableManager</code> to maintain state during execution.</li>
</ul>
<h3 id="22-flowagentbuilder">2.2. <code>FlowAgentBuilder</code><a class="headerlink" href="#22-flowagentbuilder" title="Permanent link">&para;</a></h3>
<p>The <code>FlowAgentBuilder</code> is the exclusive method for configuring and creating <code>FlowAgent</code> instances. It provides a fluent API that promotes clear and maintainable agent definitions.</p>
<ul>
<li><strong>Configuration as Code:</strong> Define every aspect of an agent—models, persona, tools, and features—programmatically.</li>
<li><strong>Serializable Config:</strong> The builder's state is backed by a Pydantic model (<code>AgentConfig</code>), allowing any agent's configuration to be saved to and loaded from a JSON or YAML file.</li>
<li><strong>Centralized Setup:</strong> ISAA uses the builder to inject core tools and system-wide configurations automatically.</li>
</ul>
<h3 id="23-toolsinterface">2.3. <code>ToolsInterface</code><a class="headerlink" href="#23-toolsinterface" title="Permanent link">&para;</a></h3>
<p>Replacing the previous <code>Pipeline</code> system, the <code>ToolsInterface</code> is a stateful execution environment that is <strong>directly tied to an agent instance</strong>. It provides a powerful set of tools for interacting with the outside world.</p>
<ul>
<li><strong>Agent-Specific Environment:</strong> Each agent gets its own sandboxed <code>ToolsInterface</code> to manage files, execute code, and maintain state without interfering with other agents.</li>
<li><strong>Rich Toolset:</strong> Provides tools for file I/O (<code>read_file</code>, <code>write_file</code>, <code>list_directory</code>), multi-language code execution (<code>execute_python</code>), and web browsing.</li>
<li><strong>Automatic Integration:</strong> When an agent is created via <code>isaa.get_agent_builder()</code>, the relevant tools from its <code>ToolsInterface</code> are automatically added to the agent's capabilities.</li>
</ul>
<h3 id="24-aisemanticmemory">2.4. <code>AISemanticMemory</code><a class="headerlink" href="#24-aisemanticmemory" title="Permanent link">&para;</a></h3>
<p><code>AISemanticMemory</code> serves as the long-term memory for the entire system. Agents can query this memory to retrieve past knowledge or save new information for future use.</p>
<h2 id="3-initialization-and-configuration-tools-class">3. Initialization and Configuration (<code>Tools</code> Class)<a class="headerlink" href="#3-initialization-and-configuration-tools-class" title="Permanent link">&para;</a></h2>
<p>The <code>Tools</code> class is the main entry point for using the ISAA module.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">toolboxv2</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_app</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">toolboxv2.mods.isaa.module</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tools</span>

<span class="c1"># Get the application instance</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">get_app</span><span class="p">(</span><span class="s2">&quot;my_application&quot;</span><span class="p">)</span>
<span class="n">isaa</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">get_mod</span><span class="p">(</span><span class="s2">&quot;isaa&quot;</span><span class="p">)</span> <span class="c1"># Assumes ISAA is registered with the app</span>

<span class="c1"># Initialize ISAA (loads configs, sets up defaults)</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">initialize_isaa</span><span class="p">():</span>
    <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">init_isaa</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ISAA initialized.&quot;</span><span class="p">)</span>

<span class="c1"># asyncio.run(initialize_isaa())</span>
</code></pre></div>
<h3 id="isaaon_exit"><code>isaa.on_exit()</code><a class="headerlink" href="#isaaon_exit" title="Permanent link">&para;</a></h3>
<p>This method ensures that all agent configurations and other states are saved gracefully when the application shuts down.</p>
<h2 id="4-agent-management">4. Agent Management<a class="headerlink" href="#4-agent-management" title="Permanent link">&para;</a></h2>
<p>All agent management is now fully asynchronous and builder-oriented.</p>
<h3 id="41-getting-an-agent-builder-get_agent_builder">4.1. Getting an Agent Builder (<code>get_agent_builder</code>)<a class="headerlink" href="#41-getting-an-agent-builder-get_agent_builder" title="Permanent link">&para;</a></h3>
<p>This is the starting point for creating any new agent. It returns a <code>FlowAgentBuilder</code> pre-configured with ISAA's core tools.</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">manage_agent_builder</span><span class="p">():</span>
    <span class="c1"># Get a builder for an agent named &quot;coder_agent&quot;</span>
    <span class="n">coder_builder</span> <span class="o">=</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent_builder</span><span class="p">(</span><span class="s2">&quot;coder_agent&quot;</span><span class="p">)</span>

    <span class="c1"># Further configure the builder</span>
    <span class="n">coder_builder</span><span class="o">.</span><span class="n">with_models</span><span class="p">(</span>
        <span class="n">fast_llm_model</span><span class="o">=</span><span class="s2">&quot;openrouter/anthropic/claude-3-haiku&quot;</span><span class="p">,</span>
        <span class="n">complex_llm_model</span><span class="o">=</span><span class="s2">&quot;openrouter/openai/gpt-4o&quot;</span>
    <span class="p">)</span>
    <span class="n">coder_builder</span><span class="o">.</span><span class="n">with_system_message</span><span class="p">(</span><span class="s2">&quot;You are a master Python programmer.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">coder_builder</span>
</code></pre></div>
<h3 id="42-registering-an-agent-async-register_agent">4.2. Registering an Agent (<code>async register_agent</code>)<a class="headerlink" href="#42-registering-an-agent-async-register_agent" title="Permanent link">&para;</a></h3>
<p>Once a builder is configured, you register its configuration with ISAA. This saves the agent's definition and makes it available for use.</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">register_my_agent</span><span class="p">():</span>
    <span class="n">builder</span> <span class="o">=</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent_builder</span><span class="p">(</span><span class="s2">&quot;my_query_agent&quot;</span><span class="p">)</span>
    <span class="n">builder</span><span class="o">.</span><span class="n">with_system_message</span><span class="p">(</span><span class="s2">&quot;You answer questions based on internal memory.&quot;</span><span class="p">)</span>

    <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">register_agent</span><span class="p">(</span><span class="n">builder</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Agent &#39;my_query_agent&#39; configuration registered.&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="43-retrieving-an-agent-instance-async-get_agent">4.3. Retrieving an Agent Instance (<code>async get_agent</code>)<a class="headerlink" href="#43-retrieving-an-agent-instance-async-get_agent" title="Permanent link">&para;</a></h3>
<p>This method builds (or retrieves from a cache) a fully operational <code>FlowAgent</code> instance from a registered configuration.</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">retrieve_and_use_agent</span><span class="p">():</span>
    <span class="c1"># This will build the agent if it&#39;s the first time it&#39;s requested</span>
    <span class="n">my_agent</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;my_query_agent&quot;</span><span class="p">)</span>

    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">my_agent</span><span class="o">.</span><span class="n">a_run</span><span class="p">(</span><span class="s2">&quot;What is the capital of France?&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</code></pre></div>
<h2 id="5-running-agents-and-tasks">5. Running Agents and Tasks<a class="headerlink" href="#5-running-agents-and-tasks" title="Permanent link">&para;</a></h2>
<h3 id="51-running-an-agent-async-run_agent">5.1. Running an Agent (<code>async run_agent</code>)<a class="headerlink" href="#51-running-an-agent-async-run_agent" title="Permanent link">&para;</a></h3>
<p>The primary method for interacting with a registered agent by name.</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run_specific_agent</span><span class="p">():</span>
    <span class="c1"># Register a simple agent if it doesn&#39;t exist</span>
    <span class="k">if</span> <span class="s2">&quot;responder&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">isaa</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;agents-name-list&quot;</span><span class="p">,</span> <span class="p">[]):</span>
        <span class="n">builder</span> <span class="o">=</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent_builder</span><span class="p">(</span><span class="s2">&quot;responder&quot;</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">register_agent</span><span class="p">(</span><span class="n">builder</span><span class="p">)</span>

    <span class="c1"># Use a session_id for conversations with persistent history</span>
    <span class="n">session_id</span> <span class="o">=</span> <span class="s2">&quot;user123_chat&quot;</span>
    <span class="n">response1</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">run_agent</span><span class="p">(</span><span class="s2">&quot;responder&quot;</span><span class="p">,</span> <span class="s2">&quot;My favorite color is blue.&quot;</span><span class="p">,</span> <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">)</span>
    <span class="n">response2</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">run_agent</span><span class="p">(</span><span class="s2">&quot;responder&quot;</span><span class="p">,</span> <span class="s2">&quot;What is my favorite color?&quot;</span><span class="p">,</span> <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Agent remembers: </span><span class="si">{</span><span class="n">response2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="52-structured-output-async-format_class">5.2. Structured Output (<code>async format_class</code>)<a class="headerlink" href="#52-structured-output-async-format_class" title="Permanent link">&para;</a></h3>
<p>Leverage an agent's reasoning to structure output according to a Pydantic model.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">Field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span>

<span class="k">class</span><span class="w"> </span><span class="nc">UserProfile</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;The user&#39;s full name.&quot;</span><span class="p">)</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;The user&#39;s age.&quot;</span><span class="p">)</span>
    <span class="n">interests</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;A list of the user&#39;s interests.&quot;</span><span class="p">)</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_structured_info</span><span class="p">():</span>
    <span class="n">profile_dict</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">format_class</span><span class="p">(</span>
        <span class="n">UserProfile</span><span class="p">,</span>
        <span class="s2">&quot;The user is Alice Smith. She is 30 years old and enjoys hiking and photography.&quot;</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">profile_dict</span><span class="p">:</span>
        <span class="n">profile</span> <span class="o">=</span> <span class="n">UserProfile</span><span class="p">(</span><span class="o">**</span><span class="n">profile_dict</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parsed User: </span><span class="si">{</span><span class="n">profile</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, Interests: </span><span class="si">{</span><span class="n">profile</span><span class="o">.</span><span class="n">interests</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="6-code-execution-with-toolsinterface">6. Code Execution with <code>ToolsInterface</code><a class="headerlink" href="#6-code-execution-with-toolsinterface" title="Permanent link">&para;</a></h2>
<p>The <code>ToolsInterface</code> provides a powerful, stateful environment for each agent to execute code, manage files, and interact with the web. <strong>You do not interact with the <code>ToolsInterface</code> directly.</strong> Instead, you instruct the agent to use the tools that ISAA has automatically provided from the interface.</p>
<p>The agent's reasoner is aware of these tools and will use them when a task requires it.</p>
<p><strong>Example: Instructing an agent to use its file and code tools.</strong>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute_code_task</span><span class="p">():</span>
    <span class="c1"># 1. Get a builder for a coding agent. ISAA will automatically add</span>
    <span class="c1">#    code and file tools from the ToolsInterface.</span>
    <span class="n">coder_builder</span> <span class="o">=</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent_builder</span><span class="p">(</span><span class="s2">&quot;PyCoder&quot;</span><span class="p">)</span>
    <span class="n">coder_builder</span><span class="o">.</span><span class="n">with_system_message</span><span class="p">(</span>
        <span class="s2">&quot;You are a Python coding assistant. You write and execute Python code to solve problems.&quot;</span>
    <span class="p">)</span>
    <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">register_agent</span><span class="p">(</span><span class="n">coder_builder</span><span class="p">)</span>

    <span class="c1"># 2. Get the agent instance</span>
    <span class="n">coder_agent</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;PyCoder&quot;</span><span class="p">)</span>

    <span class="c1"># 3. Give the agent a multi-step task involving file I/O and code execution</span>
    <span class="n">task_prompt</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;First, create a Python script named &#39;hello.py&#39; that prints &#39;Hello from ISAA!&#39;. &quot;</span>
        <span class="s2">&quot;Then, execute that script and show me the output.&quot;</span>
    <span class="p">)</span>

    <span class="c1"># The agent&#39;s reasoner will create an outline:</span>
    <span class="c1"># - Step 1: Use the `createScript` tool to write the file.</span>
    <span class="c1"># - Step 2: Use the `runScript` tool to execute it.</span>
    <span class="c1"># - Step 3: Return the captured output.</span>
    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">coder_agent</span><span class="o">.</span><span class="n">a_run</span><span class="p">(</span><span class="n">task_prompt</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Agent Response ---&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</code></pre></div></p>
<h2 id="7-semantic-memory-aisemanticmemory">7. Semantic Memory (<code>AISemanticMemory</code>)<a class="headerlink" href="#7-semantic-memory-aisemanticmemory" title="Permanent link">&para;</a></h2>
<p>Agents can interact with the shared semantic memory through the tools provided by ISAA.</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">use_semantic_memory</span><span class="p">():</span>
    <span class="c1"># Get a general-purpose agent</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;self&quot;</span><span class="p">)</span>

    <span class="c1"># Instruct the agent to save information</span>
    <span class="k">await</span> <span class="n">agent</span><span class="o">.</span><span class="n">a_run</span><span class="p">(</span><span class="s2">&quot;Please remember that the project codename is &#39;Orion&#39;.&quot;</span><span class="p">,</span> <span class="n">session_id</span><span class="o">=</span><span class="s2">&quot;project_orion&quot;</span><span class="p">)</span>

    <span class="c1"># Later, in the same or a different session, instruct it to retrieve the information</span>
    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">agent</span><span class="o">.</span><span class="n">a_run</span><span class="p">(</span><span class="s2">&quot;What is the project codename?&quot;</span><span class="p">,</span> <span class="n">session_id</span><span class="o">=</span><span class="s2">&quot;project_orion&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="c1"># The agent will use its `memorySearch` tool to find the answer.</span>
</code></pre></div>
<h2 id="8-tool-integration">8. Tool Integration<a class="headerlink" href="#8-tool-integration" title="Permanent link">&para;</a></h2>
<p>The <code>FlowAgentBuilder</code> is the central point for tool management. ISAA's <code>get_agent_builder</code> method automatically equips new builders with a powerful set of default tools.</p>
<h3 id="default-isaa-tools">Default ISAA Tools<a class="headerlink" href="#default-isaa-tools" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Core Tools</strong>: <code>searchWeb</code>, <code>shell</code>.</li>
<li><strong>Memory Tools</strong>: <code>memorySearch</code>, <code>saveDataToMemory</code>.</li>
<li><strong>Scripting Tools</strong>: <code>createScript</code>, <code>runScript</code>, <code>listScripts</code>, <code>deleteScript</code>.</li>
<li><strong><code>ToolsInterface</code> Tools</strong>: A suite of tools for file management (<code>write_file</code>, <code>read_file</code>, <code>list_directory</code>), code execution (<code>execute_python</code>), and more, tailored to the agent's purpose.</li>
</ul>
<h3 id="adding-your-own-tools">Adding Your Own Tools<a class="headerlink" href="#adding-your-own-tools" title="Permanent link">&para;</a></h3>
<p>You can easily add your own custom functions to any agent builder.
<div class="highlight"><pre><span></span><code><span class="c1"># 1. Define your custom async function</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_database_user_count</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the current number of users in the database.&quot;&quot;&quot;</span>
    <span class="c1"># In a real scenario, this would connect to a database</span>
    <span class="k">return</span> <span class="mi">1337</span>

<span class="c1"># 2. Get a builder and add your tool</span>
<span class="n">my_builder</span> <span class="o">=</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent_builder</span><span class="p">(</span><span class="s2">&quot;db_agent&quot;</span><span class="p">)</span>
<span class="n">my_builder</span><span class="o">.</span><span class="n">add_tool</span><span class="p">(</span>
    <span class="n">get_database_user_count</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;getUserCount&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Fetches the total number of users from the main database.&quot;</span>
<span class="p">)</span>

<span class="c1"># 3. Register and use the agent</span>
<span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">register_agent</span><span class="p">(</span><span class="n">my_builder</span><span class="p">)</span>
<span class="n">db_agent</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;db_agent&quot;</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">db_agent</span><span class="o">.</span><span class="n">a_run</span><span class="p">(</span><span class="s2">&quot;How many users are in the system?&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</code></pre></div></p>
<h2 id="9-example-usage-flow">9. Example Usage Flow<a class="headerlink" href="#9-example-usage-flow" title="Permanent link">&para;</a></h2>
<p>This example demonstrates a complete workflow: creating an agent, giving it a complex task that requires file I/O and code execution, and getting the final result.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">toolboxv2</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_app</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">toolboxv2.mods.isaa.module</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tools</span>

<span class="c1"># --- Setup ---</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">get_app</span><span class="p">(</span><span class="s2">&quot;isaa_demo_app&quot;</span><span class="p">)</span>
<span class="n">isaa</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">get_mod</span><span class="p">(</span><span class="s2">&quot;isaa&quot;</span><span class="p">)</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main_demo</span><span class="p">():</span>
    <span class="c1"># 1. Initialize ISAA</span>
    <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">init_isaa</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ISAA Initialized.&quot;</span><span class="p">)</span>

    <span class="c1"># 2. Get a builder for a &quot;DataProcessor&quot; agent.</span>
    <span class="c1">#    ISAA will automatically add file and code execution tools.</span>
    <span class="n">data_builder</span> <span class="o">=</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent_builder</span><span class="p">(</span><span class="s2">&quot;DataProcessor&quot;</span><span class="p">)</span>
    <span class="n">data_builder</span><span class="o">.</span><span class="n">with_system_message</span><span class="p">(</span>
        <span class="s2">&quot;You are a data processing specialist. You write Python scripts to &quot;</span>
        <span class="s2">&quot;manipulate data, save it to files, and read it back.&quot;</span>
    <span class="p">)</span>
    <span class="n">data_builder</span><span class="o">.</span><span class="n">with_models</span><span class="p">(</span>
        <span class="n">fast_llm_model</span><span class="o">=</span><span class="s2">&quot;openrouter/anthropic/claude-3-haiku&quot;</span><span class="p">,</span>
        <span class="n">complex_llm_model</span><span class="o">=</span><span class="s2">&quot;openrouter/openai/gpt-4o&quot;</span>
    <span class="p">)</span>

    <span class="c1"># 3. Register the agent&#39;s configuration</span>
    <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">register_agent</span><span class="p">(</span><span class="n">data_builder</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DataProcessor agent registered.&quot;</span><span class="p">)</span>

    <span class="c1"># 4. Get the agent instance</span>
    <span class="n">data_agent</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;DataProcessor&quot;</span><span class="p">)</span>

    <span class="c1"># 5. Define a multi-step task for the agent</span>
    <span class="n">user_task</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;I need you to perform a data processing task. Here are the steps:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;1. Create a Python script called &#39;process.py&#39;.</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;2. The script should create a list of numbers from 1 to 10 and calculate their sum.</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;3. It must then write the result to a file named &#39;result.txt&#39; in the format: &#39;The sum is: [sum]&#39;.</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;4. After creating the script, execute it.</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;5. Finally, read the content of &#39;result.txt&#39; and tell me what it says.&quot;</span>
    <span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Running Agent for Task ---</span><span class="se">\n</span><span class="si">{</span><span class="n">user_task</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># 6. Run the agent</span>
    <span class="c1"># The agent will use its internal reasoner to create an outline and use its</span>
    <span class="c1"># `createScript`, `runScript`, and `read_file` tools to complete the task.</span>
    <span class="n">final_response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">data_agent</span><span class="o">.</span><span class="n">a_run</span><span class="p">(</span><span class="n">user_task</span><span class="p">,</span> <span class="n">session_id</span><span class="o">=</span><span class="s2">&quot;data_processing_task_01&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Final Agent Response ---&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">final_response</span><span class="p">)</span>

    <span class="c1"># 7. Check the agent&#39;s status</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Agent Status ---&quot;</span><span class="p">)</span>
    <span class="n">data_agent</span><span class="o">.</span><span class="n">status</span><span class="p">(</span><span class="n">pretty_print</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">await</span> <span class="n">data_agent</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># --- Run the Demo ---</span>
<span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main_demo</span><span class="p">())</span>
</code></pre></div>
<h2 id="10-important-notes">10. Important Notes<a class="headerlink" href="#10-important-notes" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Asynchronous First</strong>: The entire ISAA module is built around <code>asyncio</code>. Ensure your code is running in an async context.</li>
<li><strong>Configuration is Key</strong>: An agent's performance is highly dependent on its configuration, especially its system message, persona, and the tools it has access to.</li>
<li><strong>Security</strong>: Be extremely cautious when using tools that can execute code (<code>execute_python</code>) or shell commands (<code>shell</code>). The default <code>ToolsInterface</code> is sandboxed to a specific directory, but care should always be taken. Avoid exposing these agents to untrusted inputs.</li>
<li><strong>State and Sessions</strong>: Use <code>session_id</code> to maintain distinct conversational contexts for different users or tasks. The agent's memory and state are tied to this ID.</li>
</ul>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>The Chain system provides a powerful way to orchestrate multiple ISAA agents in complex workflows. Chains allow you to create sophisticated AI pipelines with sequential execution, parallel processing, conditional branching, error handling, and automatic data formatting between agents.</p>
<h2 id="core-concepts">Core Concepts<a class="headerlink" href="#core-concepts" title="Permanent link">&para;</a></h2>
<h3 id="1-basic-chain-operations">1. Basic Chain Operations<a class="headerlink" href="#1-basic-chain-operations" title="Permanent link">&para;</a></h3>
<p>The chain system uses intuitive operators to define workflows:</p>
<ul>
<li><code>&gt;&gt;</code> : Sequential execution (pipe operator)</li>
<li><code>+</code> or <code>&amp;</code> : Parallel execution</li>
<li><code>%</code> : Conditional branching</li>
<li><code>|</code> : Error handling (try/catch)</li>
<li><code>-</code> : Data extraction and formatting</li>
</ul>
<h3 id="2-chain-components">2. Chain Components<a class="headerlink" href="#2-chain-components" title="Permanent link">&para;</a></h3>
<h4 id="cf-chain-format"><strong>CF (Chain Format)</strong><a class="headerlink" href="#cf-chain-format" title="Permanent link">&para;</a></h4>
<p>Handles data transformation and extraction between agents using Pydantic models.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>

<span class="k">class</span><span class="w"> </span><span class="nc">UserProfile</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">interests</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>

<span class="c1"># Create a formatter</span>
<span class="n">profile_format</span> <span class="o">=</span> <span class="n">CF</span><span class="p">(</span><span class="n">UserProfile</span><span class="p">)</span>
</code></pre></div>
<h4 id="is-conditional-check"><strong>IS (Conditional Check)</strong><a class="headerlink" href="#is-conditional-check" title="Permanent link">&para;</a></h4>
<p>Creates conditional logic based on data values.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Check if age is over 18</span>
<span class="n">adult_check</span> <span class="o">=</span> <span class="n">IS</span><span class="p">(</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span>
</code></pre></div>
<h2 id="basic-usage">Basic Usage<a class="headerlink" href="#basic-usage" title="Permanent link">&para;</a></h2>
<h3 id="1-setting-up-agents-for-chaining">1. Setting Up Agents for Chaining<a class="headerlink" href="#1-setting-up-agents-for-chaining" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">toolboxv2</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_app</span>

<span class="c1"># Initialize ISAA</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">get_app</span><span class="p">(</span><span class="s2">&quot;chain_demo&quot;</span><span class="p">)</span>
<span class="n">isaa</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">get_mod</span><span class="p">(</span><span class="s2">&quot;isaa&quot;</span><span class="p">)</span>
<span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">init_isaa</span><span class="p">()</span>

<span class="c1"># Create specialized agents</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">setup_agents</span><span class="p">():</span>
    <span class="c1"># Data extractor agent</span>
    <span class="n">extractor_builder</span> <span class="o">=</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent_builder</span><span class="p">(</span><span class="s2">&quot;data_extractor&quot;</span><span class="p">)</span>
    <span class="n">extractor_builder</span><span class="o">.</span><span class="n">with_system_message</span><span class="p">(</span>
        <span class="s2">&quot;You extract structured information from text. Always provide complete, accurate data.&quot;</span>
    <span class="p">)</span>
    <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">register_agent</span><span class="p">(</span><span class="n">extractor_builder</span><span class="p">)</span>

    <span class="c1"># Analyzer agent</span>
    <span class="n">analyzer_builder</span> <span class="o">=</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent_builder</span><span class="p">(</span><span class="s2">&quot;analyzer&quot;</span><span class="p">)</span>
    <span class="n">analyzer_builder</span><span class="o">.</span><span class="n">with_system_message</span><span class="p">(</span>
        <span class="s2">&quot;You analyze data and provide insights and recommendations.&quot;</span>
    <span class="p">)</span>
    <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">register_agent</span><span class="p">(</span><span class="n">analyzer_builder</span><span class="p">)</span>

    <span class="c1"># Report generator</span>
    <span class="n">reporter_builder</span> <span class="o">=</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent_builder</span><span class="p">(</span><span class="s2">&quot;reporter&quot;</span><span class="p">)</span>
    <span class="n">reporter_builder</span><span class="o">.</span><span class="n">with_system_message</span><span class="p">(</span>
        <span class="s2">&quot;You create detailed reports from analysis data.&quot;</span>
    <span class="p">)</span>
    <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">register_agent</span><span class="p">(</span><span class="n">reporter_builder</span><span class="p">)</span>

<span class="k">await</span> <span class="n">setup_agents</span><span class="p">()</span>
</code></pre></div>
<h3 id="2-simple-sequential-chain">2. Simple Sequential Chain<a class="headerlink" href="#2-simple-sequential-chain" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">simple_sequential_chain</span><span class="p">():</span>
    <span class="c1"># Get agent instances</span>
    <span class="n">extractor</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;data_extractor&quot;</span><span class="p">)</span>
    <span class="n">analyzer</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;analyzer&quot;</span><span class="p">)</span>
    <span class="n">reporter</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;reporter&quot;</span><span class="p">)</span>

    <span class="c1"># Create a sequential chain</span>
    <span class="n">chain</span> <span class="o">=</span> <span class="n">extractor</span> <span class="o">&gt;&gt;</span> <span class="n">analyzer</span> <span class="o">&gt;&gt;</span> <span class="n">reporter</span>

    <span class="c1"># Execute the chain</span>
    <span class="n">user_text</span> <span class="o">=</span> <span class="s2">&quot;John Smith is 25 years old and loves hiking, photography, and cooking.&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">chain</span><span class="o">.</span><span class="n">a_run</span><span class="p">(</span><span class="n">user_text</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Final Report:&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

<span class="c1"># Run the chain</span>
<span class="k">await</span> <span class="n">simple_sequential_chain</span><span class="p">()</span>
</code></pre></div>
<h2 id="advanced-chain-features">Advanced Chain Features<a class="headerlink" href="#advanced-chain-features" title="Permanent link">&para;</a></h2>
<h3 id="1-data-formatting-with-cf">1. Data Formatting with CF<a class="headerlink" href="#1-data-formatting-with-cf" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PersonData</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">interests</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Unknown&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Analysis</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">profile_summary</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">recommendations</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">risk_score</span><span class="p">:</span> <span class="nb">int</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">formatted_chain</span><span class="p">():</span>
    <span class="n">extractor</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;data_extractor&quot;</span><span class="p">)</span>
    <span class="n">analyzer</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;analyzer&quot;</span><span class="p">)</span>

    <span class="c1"># Chain with structured data formatting</span>
    <span class="n">chain</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">extractor</span> <span class="o">&gt;&gt;</span>
        <span class="n">CF</span><span class="p">(</span><span class="n">PersonData</span><span class="p">)</span> <span class="o">&gt;&gt;</span>
        <span class="n">analyzer</span> <span class="o">&gt;&gt;</span>
        <span class="n">CF</span><span class="p">(</span><span class="n">Analysis</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">user_input</span> <span class="o">=</span> <span class="s2">&quot;Sarah Johnson, 28, lives in Seattle. Enjoys rock climbing, programming, and yoga.&quot;</span>

    <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">chain</span><span class="o">.</span><span class="n">a_run</span><span class="p">(</span><span class="n">user_input</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Structured Result:&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

<span class="k">await</span> <span class="n">formatted_chain</span><span class="p">()</span>
</code></pre></div>
<h3 id="2-data-extraction-with-key-selection">2. Data Extraction with Key Selection<a class="headerlink" href="#2-data-extraction-with-key-selection" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">extraction_chain</span><span class="p">():</span>
    <span class="n">extractor</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;data_extractor&quot;</span><span class="p">)</span>
    <span class="n">analyzer</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;analyzer&quot;</span><span class="p">)</span>

    <span class="c1"># Extract specific fields using the - operator</span>
    <span class="n">chain</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">extractor</span> <span class="o">&gt;&gt;</span>
        <span class="n">CF</span><span class="p">(</span><span class="n">PersonData</span><span class="p">)</span> <span class="o">-</span> <span class="s2">&quot;interests&quot;</span> <span class="o">&gt;&gt;</span>  <span class="c1"># Extract only interests</span>
        <span class="n">analyzer</span>
    <span class="p">)</span>

    <span class="c1"># Extract multiple fields</span>
    <span class="n">multi_extract_chain</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">extractor</span> <span class="o">&gt;&gt;</span>
        <span class="n">CF</span><span class="p">(</span><span class="n">PersonData</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">)</span> <span class="o">&gt;&gt;</span>  <span class="c1"># Extract name and age</span>
        <span class="n">analyzer</span>
    <span class="p">)</span>

    <span class="c1"># Extract all fields</span>
    <span class="n">all_extract_chain</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">extractor</span> <span class="o">&gt;&gt;</span>
        <span class="n">CF</span><span class="p">(</span><span class="n">PersonData</span><span class="p">)</span> <span class="o">-</span> <span class="s2">&quot;*&quot;</span> <span class="o">&gt;&gt;</span>  <span class="c1"># Extract everything</span>
        <span class="n">analyzer</span>
    <span class="p">)</span>

    <span class="n">user_input</span> <span class="o">=</span> <span class="s2">&quot;Mike loves surfing and coding. He&#39;s 30 years old.&quot;</span>

    <span class="n">result1</span> <span class="o">=</span> <span class="k">await</span> <span class="n">chain</span><span class="o">.</span><span class="n">a_run</span><span class="p">(</span><span class="n">user_input</span><span class="p">)</span>
    <span class="n">result2</span> <span class="o">=</span> <span class="k">await</span> <span class="n">multi_extract_chain</span><span class="o">.</span><span class="n">a_run</span><span class="p">(</span><span class="n">user_input</span><span class="p">)</span>
    <span class="n">result3</span> <span class="o">=</span> <span class="k">await</span> <span class="n">all_extract_chain</span><span class="o">.</span><span class="n">a_run</span><span class="p">(</span><span class="n">user_input</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Interests only:&quot;</span><span class="p">,</span> <span class="n">result1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Name and age:&quot;</span><span class="p">,</span> <span class="n">result2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All data:&quot;</span><span class="p">,</span> <span class="n">result3</span><span class="p">)</span>

<span class="k">await</span> <span class="n">extraction_chain</span><span class="p">()</span>
</code></pre></div>
<h3 id="3-parallel-processing">3. Parallel Processing<a class="headerlink" href="#3-parallel-processing" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">parallel_chain</span><span class="p">():</span>
    <span class="n">analyzer</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;analyzer&quot;</span><span class="p">)</span>
    <span class="n">reporter</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;reporter&quot;</span><span class="p">)</span>

    <span class="c1"># Create a specialized summarizer</span>
    <span class="n">summarizer_builder</span> <span class="o">=</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent_builder</span><span class="p">(</span><span class="s2">&quot;summarizer&quot;</span><span class="p">)</span>
    <span class="n">summarizer_builder</span><span class="o">.</span><span class="n">with_system_message</span><span class="p">(</span><span class="s2">&quot;You create concise summaries.&quot;</span><span class="p">)</span>
    <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">register_agent</span><span class="p">(</span><span class="n">summarizer_builder</span><span class="p">)</span>

    <span class="n">summarizer</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;summarizer&quot;</span><span class="p">)</span>

    <span class="c1"># Parallel execution using + operator</span>
    <span class="n">parallel_chain</span> <span class="o">=</span> <span class="n">analyzer</span> <span class="o">+</span> <span class="n">reporter</span> <span class="o">+</span> <span class="n">summarizer</span>

    <span class="c1"># Sequential then parallel</span>
    <span class="n">extractor</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;data_extractor&quot;</span><span class="p">)</span>
    <span class="n">complex_chain</span> <span class="o">=</span> <span class="n">extractor</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="n">analyzer</span> <span class="o">+</span> <span class="n">reporter</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;Complex project data with multiple stakeholders and requirements...&quot;</span>

    <span class="c1"># This will run analyzer, reporter, and summarizer simultaneously</span>
    <span class="n">parallel_result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">parallel_chain</span><span class="o">.</span><span class="n">a_run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parallel Results:&quot;</span><span class="p">,</span> <span class="n">parallel_result</span><span class="p">)</span>

    <span class="c1"># This will run extractor first, then analyzer and reporter in parallel</span>
    <span class="n">complex_result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">complex_chain</span><span class="o">.</span><span class="n">a_run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Complex Chain Result:&quot;</span><span class="p">,</span> <span class="n">complex_result</span><span class="p">)</span>

<span class="k">await</span> <span class="n">parallel_chain</span><span class="p">()</span>
</code></pre></div>
<h3 id="4-auto-parallel-processing">4. Auto-Parallel Processing<a class="headerlink" href="#4-auto-parallel-processing" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">TaskList</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">tasks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">priority</span><span class="p">:</span> <span class="nb">str</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">auto_parallel_chain</span><span class="p">():</span>
    <span class="n">extractor</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;data_extractor&quot;</span><span class="p">)</span>
    <span class="n">analyzer</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;analyzer&quot;</span><span class="p">)</span>

    <span class="c1"># Auto-parallel: Process each task in the list simultaneously</span>
    <span class="n">chain</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">extractor</span> <span class="o">&gt;&gt;</span>
        <span class="n">CF</span><span class="p">(</span><span class="n">TaskList</span><span class="p">)</span> <span class="o">-</span> <span class="s2">&quot;tasks[n]&quot;</span> <span class="o">&gt;&gt;</span>  <span class="c1"># [n] creates auto-parallel</span>
        <span class="n">analyzer</span>
    <span class="p">)</span>

    <span class="n">input_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    I have these tasks to analyze:</span>
<span class="s2">    - Review quarterly reports</span>
<span class="s2">    - Plan next sprint</span>
<span class="s2">    - Update documentation</span>
<span class="s2">    - Conduct team interviews</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="c1"># The analyzer will process each task in parallel automatically</span>
    <span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">chain</span><span class="o">.</span><span class="n">a_run</span><span class="p">(</span><span class="n">input_text</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Auto-parallel Results:&quot;</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>

<span class="k">await</span> <span class="n">auto_parallel_chain</span><span class="p">()</span>
</code></pre></div>
<h3 id="5-conditional-chains">5. Conditional Chains<a class="headerlink" href="#5-conditional-chains" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">conditional_chain</span><span class="p">():</span>
    <span class="n">extractor</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;data_extractor&quot;</span><span class="p">)</span>
    <span class="n">analyzer</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;analyzer&quot;</span><span class="p">)</span>
    <span class="n">reporter</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;reporter&quot;</span><span class="p">)</span>

    <span class="c1"># Create a simple approval agent</span>
    <span class="n">approver_builder</span> <span class="o">=</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent_builder</span><span class="p">(</span><span class="s2">&quot;approver&quot;</span><span class="p">)</span>
    <span class="n">approver_builder</span><span class="o">.</span><span class="n">with_system_message</span><span class="p">(</span>
        <span class="s2">&quot;You approve or reject based on criteria. Return &#39;approved&#39; or &#39;rejected&#39;.&quot;</span>
    <span class="p">)</span>
    <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">register_agent</span><span class="p">(</span><span class="n">approver_builder</span><span class="p">)</span>
    <span class="n">approver</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;approver&quot;</span><span class="p">)</span>

    <span class="c1"># Conditional chain: different paths based on approval</span>
    <span class="n">chain</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">extractor</span> <span class="o">&gt;&gt;</span>
        <span class="n">approver</span> <span class="o">&gt;&gt;</span>
        <span class="n">IS</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;approved&quot;</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">reporter</span> <span class="o">%</span>  <span class="c1"># If approved, generate report</span>
        <span class="n">analyzer</span>  <span class="c1"># If not approved, send to analyzer for revision</span>
    <span class="p">)</span>

    <span class="n">approved_request</span> <span class="o">=</span> <span class="s2">&quot;This is a well-structured, reasonable business proposal.&quot;</span>
    <span class="n">rejected_request</span> <span class="o">=</span> <span class="s2">&quot;This request lacks proper documentation and justification.&quot;</span>

    <span class="n">result1</span> <span class="o">=</span> <span class="k">await</span> <span class="n">chain</span><span class="o">.</span><span class="n">a_run</span><span class="p">(</span><span class="n">approved_request</span><span class="p">)</span>  <span class="c1"># Goes to reporter</span>
    <span class="n">result2</span> <span class="o">=</span> <span class="k">await</span> <span class="n">chain</span><span class="o">.</span><span class="n">a_run</span><span class="p">(</span><span class="n">rejected_request</span><span class="p">)</span>  <span class="c1"># Goes to analyzer</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Approved path result:&quot;</span><span class="p">,</span> <span class="n">result1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Rejected path result:&quot;</span><span class="p">,</span> <span class="n">result2</span><span class="p">)</span>

<span class="k">await</span> <span class="n">conditional_chain</span><span class="p">()</span>
</code></pre></div>
<h3 id="6-error-handling-chains">6. Error Handling Chains<a class="headerlink" href="#6-error-handling-chains" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">error_handling_chain</span><span class="p">():</span>
    <span class="c1"># Create a potentially failing agent</span>
    <span class="n">risky_builder</span> <span class="o">=</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent_builder</span><span class="p">(</span><span class="s2">&quot;risky_processor&quot;</span><span class="p">)</span>
    <span class="n">risky_builder</span><span class="o">.</span><span class="n">with_system_message</span><span class="p">(</span>
        <span class="s2">&quot;You process data but sometimes fail. Randomly throw errors for demonstration.&quot;</span>
    <span class="p">)</span>
    <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">register_agent</span><span class="p">(</span><span class="n">risky_builder</span><span class="p">)</span>

    <span class="n">risky_agent</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;risky_processor&quot;</span><span class="p">)</span>
    <span class="n">safe_agent</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;analyzer&quot;</span><span class="p">)</span>  <span class="c1"># Fallback</span>

    <span class="c1"># Error handling chain using | operator</span>
    <span class="n">chain</span> <span class="o">=</span> <span class="n">risky_agent</span> <span class="o">|</span> <span class="n">safe_agent</span>

    <span class="c1"># If risky_agent fails, safe_agent will handle it</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">chain</span><span class="o">.</span><span class="n">a_run</span><span class="p">(</span><span class="s2">&quot;Process this potentially problematic data&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Chain completed:&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Chain failed despite fallback:&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

<span class="k">await</span> <span class="n">error_handling_chain</span><span class="p">()</span>
</code></pre></div>
<h2 id="complex-workflow-examples">Complex Workflow Examples<a class="headerlink" href="#complex-workflow-examples" title="Permanent link">&para;</a></h2>
<h3 id="1-multi-stage-document-processing">1. Multi-Stage Document Processing<a class="headerlink" href="#1-multi-stage-document-processing" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DocumentMetadata</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">author</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">document_type</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">complexity_score</span><span class="p">:</span> <span class="nb">int</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ProcessingResult</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">summary</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">key_points</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">action_items</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">document_processing_workflow</span><span class="p">():</span>
    <span class="c1"># Set up specialized agents</span>
    <span class="n">metadata_extractor</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;data_extractor&quot;</span><span class="p">)</span>
    <span class="n">content_analyzer</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;analyzer&quot;</span><span class="p">)</span>
    <span class="n">summarizer</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;summarizer&quot;</span><span class="p">)</span>
    <span class="n">action_extractor</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;reporter&quot;</span><span class="p">)</span>

    <span class="c1"># Complex multi-path workflow</span>
    <span class="n">workflow</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">metadata_extractor</span> <span class="o">&gt;&gt;</span>
        <span class="n">CF</span><span class="p">(</span><span class="n">DocumentMetadata</span><span class="p">)</span> <span class="o">&gt;&gt;</span>
        <span class="c1"># Branch based on complexity</span>
        <span class="p">(</span><span class="n">IS</span><span class="p">(</span><span class="s2">&quot;complexity_score&quot;</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">)</span> <span class="o">&gt;&gt;</span>
         <span class="p">(</span><span class="n">content_analyzer</span> <span class="o">+</span> <span class="n">summarizer</span><span class="p">)</span> <span class="o">&gt;&gt;</span>  <span class="c1"># Parallel processing for complex docs</span>
         <span class="n">action_extractor</span><span class="p">)</span> <span class="o">%</span>
        <span class="p">(</span><span class="n">summarizer</span> <span class="o">&gt;&gt;</span> <span class="n">action_extractor</span><span class="p">)</span> <span class="o">&gt;&gt;</span>  <span class="c1"># Simple path for easy docs</span>
        <span class="n">CF</span><span class="p">(</span><span class="n">ProcessingResult</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">complex_doc</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Title: Advanced AI Architecture Proposal</span>
<span class="s2">    Author: Dr. Sarah Chen</span>
<span class="s2">    Type: Technical Specification</span>

<span class="s2">    This document outlines a comprehensive approach to implementing</span>
<span class="s2">    next-generation AI systems with distributed processing capabilities...</span>
<span class="s2">    [Complex technical content continues...]</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="n">simple_doc</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Title: Meeting Notes</span>
<span class="s2">    Author: John Smith</span>
<span class="s2">    Type: Meeting Minutes</span>

<span class="s2">    Brief discussion about quarterly goals and upcoming deadlines.</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="n">complex_result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">workflow</span><span class="o">.</span><span class="n">a_run</span><span class="p">(</span><span class="n">complex_doc</span><span class="p">)</span>
    <span class="n">simple_result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">workflow</span><span class="o">.</span><span class="n">a_run</span><span class="p">(</span><span class="n">simple_doc</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Complex Document Result:&quot;</span><span class="p">,</span> <span class="n">complex_result</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simple Document Result:&quot;</span><span class="p">,</span> <span class="n">simple_result</span><span class="p">)</span>

<span class="k">await</span> <span class="n">document_processing_workflow</span><span class="p">()</span>
</code></pre></div>
<h3 id="2-customer-service-chain">2. Customer Service Chain<a class="headerlink" href="#2-customer-service-chain" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CustomerInquiry</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">customer_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">inquiry_type</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">priority</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">issue_description</span><span class="p">:</span> <span class="nb">str</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ServiceResponse</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">response_text</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">escalation_needed</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">follow_up_required</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">estimated_resolution_time</span><span class="p">:</span> <span class="nb">str</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">customer_service_chain</span><span class="p">():</span>
    <span class="c1"># Specialized customer service agents</span>
    <span class="n">classifier</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;data_extractor&quot;</span><span class="p">)</span>  <span class="c1"># Classifies inquiries</span>
    <span class="n">support_agent</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;analyzer&quot;</span><span class="p">)</span>     <span class="c1"># Handles standard issues</span>
    <span class="n">specialist</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;reporter&quot;</span><span class="p">)</span>        <span class="c1"># Handles complex issues</span>

    <span class="c1"># Customer service workflow</span>
    <span class="n">service_chain</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">classifier</span> <span class="o">&gt;&gt;</span>
        <span class="n">CF</span><span class="p">(</span><span class="n">CustomerInquiry</span><span class="p">)</span> <span class="o">&gt;&gt;</span>
        <span class="c1"># Route based on priority</span>
        <span class="p">(</span><span class="n">IS</span><span class="p">(</span><span class="s2">&quot;priority&quot;</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">specialist</span><span class="p">)</span> <span class="o">%</span>      <span class="c1"># High priority to specialist</span>
        <span class="p">(</span><span class="n">IS</span><span class="p">(</span><span class="s2">&quot;priority&quot;</span><span class="p">,</span> <span class="s2">&quot;medium&quot;</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">support_agent</span><span class="p">)</span> <span class="o">%</span>  <span class="c1"># Medium to support</span>
        <span class="n">support_agent</span> <span class="o">&gt;&gt;</span>                               <span class="c1"># Low to standard support</span>
        <span class="n">CF</span><span class="p">(</span><span class="n">ServiceResponse</span><span class="p">)</span> <span class="o">|</span>
        <span class="c1"># Fallback for any errors</span>
        <span class="s2">&quot;I apologize, but I&#39;m unable to process your request right now. Please contact our support team directly.&quot;</span>
    <span class="p">)</span>

    <span class="n">high_priority</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Customer ID: CUST001</span>
<span class="s2">    Issue: Critical system outage affecting production</span>
<span class="s2">    Priority: HIGH</span>
<span class="s2">    Description: Our entire payment system is down, affecting thousands of transactions.</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="n">low_priority</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Customer ID: CUST002</span>
<span class="s2">    Issue: Question about account settings</span>
<span class="s2">    Priority: LOW</span>
<span class="s2">    Description: How do I change my email preferences?</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="n">high_result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">service_chain</span><span class="o">.</span><span class="n">a_run</span><span class="p">(</span><span class="n">high_priority</span><span class="p">)</span>
    <span class="n">low_result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">service_chain</span><span class="o">.</span><span class="n">a_run</span><span class="p">(</span><span class="n">low_priority</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;High Priority Response:&quot;</span><span class="p">,</span> <span class="n">high_result</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Low Priority Response:&quot;</span><span class="p">,</span> <span class="n">low_result</span><span class="p">)</span>

<span class="k">await</span> <span class="n">customer_service_chain</span><span class="p">()</span>
</code></pre></div>
<h2 id="chain-visualization-and-debugging">Chain Visualization and Debugging<a class="headerlink" href="#chain-visualization-and-debugging" title="Permanent link">&para;</a></h2>
<h3 id="1-visualize-chain-structure">1. Visualize Chain Structure<a class="headerlink" href="#1-visualize-chain-structure" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">visualize_chain</span><span class="p">():</span>
    <span class="n">extractor</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;data_extractor&quot;</span><span class="p">)</span>
    <span class="n">analyzer</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;analyzer&quot;</span><span class="p">)</span>
    <span class="n">reporter</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;reporter&quot;</span><span class="p">)</span>

    <span class="c1"># Create a complex chain</span>
    <span class="n">complex_chain</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">extractor</span> <span class="o">&gt;&gt;</span>
        <span class="n">CF</span><span class="p">(</span><span class="n">PersonData</span><span class="p">)</span> <span class="o">-</span> <span class="s2">&quot;interests[n]&quot;</span> <span class="o">&gt;&gt;</span>  <span class="c1"># Auto-parallel</span>
        <span class="p">(</span><span class="n">analyzer</span> <span class="o">+</span> <span class="n">reporter</span><span class="p">)</span> <span class="o">&gt;&gt;</span>            <span class="c1"># Parallel processing</span>
        <span class="n">CF</span><span class="p">(</span><span class="n">Analysis</span><span class="p">)</span> <span class="o">|</span>                      <span class="c1"># Error handling</span>
        <span class="s2">&quot;Fallback response&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Visualize the chain structure</span>
    <span class="n">complex_chain</span><span class="o">.</span><span class="n">print_graph</span><span class="p">()</span>

<span class="k">await</span> <span class="n">visualize_chain</span><span class="p">()</span>
</code></pre></div>
<h3 id="2-progress-tracking">2. Progress Tracking<a class="headerlink" href="#2-progress-tracking" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">toolboxv2.mods.isaa.base.Agent.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProgressEvent</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ChainProgressTracker</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">events</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">emit_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">ProgressEvent</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">event_type</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">node_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">tracked_chain</span><span class="p">():</span>
    <span class="n">extractor</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;data_extractor&quot;</span><span class="p">)</span>
    <span class="n">analyzer</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;analyzer&quot;</span><span class="p">)</span>

    <span class="n">chain</span> <span class="o">=</span> <span class="n">extractor</span> <span class="o">&gt;&gt;</span> <span class="n">analyzer</span>

    <span class="c1"># Set up progress tracking</span>
    <span class="n">tracker</span> <span class="o">=</span> <span class="n">ChainProgressTracker</span><span class="p">()</span>
    <span class="n">chain</span><span class="o">.</span><span class="n">set_progress_callback</span><span class="p">(</span><span class="n">tracker</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">chain</span><span class="o">.</span><span class="n">a_run</span><span class="p">(</span><span class="s2">&quot;Process this data with tracking&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Progress Events:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">tracker</span><span class="o">.</span><span class="n">events</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">event_type</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">await</span> <span class="n">tracked_chain</span><span class="p">()</span>
</code></pre></div>
<h2 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">&para;</a></h2>
<h3 id="1-agent-specialization">1. Agent Specialization<a class="headerlink" href="#1-agent-specialization" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">specialized_agents_example</span><span class="p">():</span>
    <span class="c1"># Create highly specialized agents for better chain performance</span>

    <span class="c1"># JSON extractor</span>
    <span class="n">json_extractor_builder</span> <span class="o">=</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent_builder</span><span class="p">(</span><span class="s2">&quot;json_extractor&quot;</span><span class="p">)</span>
    <span class="n">json_extractor_builder</span><span class="o">.</span><span class="n">with_system_message</span><span class="p">(</span>
        <span class="s2">&quot;You extract data and return it in valid JSON format. Always use proper JSON syntax.&quot;</span>
    <span class="p">)</span>
    <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">register_agent</span><span class="p">(</span><span class="n">json_extractor_builder</span><span class="p">)</span>

    <span class="c1"># Validator agent</span>
    <span class="n">validator_builder</span> <span class="o">=</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent_builder</span><span class="p">(</span><span class="s2">&quot;validator&quot;</span><span class="p">)</span>
    <span class="n">validator_builder</span><span class="o">.</span><span class="n">with_system_message</span><span class="p">(</span>
        <span class="s2">&quot;You validate data for completeness and accuracy. Return &#39;valid&#39; or &#39;invalid&#39; with reasons.&quot;</span>
    <span class="p">)</span>
    <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">register_agent</span><span class="p">(</span><span class="n">validator_builder</span><span class="p">)</span>

    <span class="c1"># Clean chain with specialized agents</span>
    <span class="n">extraction_chain</span> <span class="o">=</span> <span class="p">(</span>
        <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;json_extractor&quot;</span><span class="p">)</span> <span class="o">&gt;&gt;</span>
        <span class="n">CF</span><span class="p">(</span><span class="n">PersonData</span><span class="p">)</span> <span class="o">&gt;&gt;</span>
        <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;validator&quot;</span><span class="p">)</span> <span class="o">&gt;&gt;</span>
        <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;analyzer&quot;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">extraction_chain</span>
</code></pre></div>
<h3 id="2-error-recovery-patterns">2. Error Recovery Patterns<a class="headerlink" href="#2-error-recovery-patterns" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">robust_chain_pattern</span><span class="p">():</span>
    <span class="n">primary_agent</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;analyzer&quot;</span><span class="p">)</span>
    <span class="n">backup_agent</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;data_extractor&quot;</span><span class="p">)</span>

    <span class="c1"># Multi-layer error recovery</span>
    <span class="n">robust_chain</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">primary_agent</span> <span class="o">|</span>                    <span class="c1"># Try primary</span>
        <span class="p">(</span><span class="n">backup_agent</span> <span class="o">&gt;&gt;</span> <span class="n">primary_agent</span><span class="p">)</span> <span class="o">|</span>  <span class="c1"># Try backup + primary</span>
        <span class="s2">&quot;Unable to process request&quot;</span>        <span class="c1"># Final fallback</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">robust_chain</span>
</code></pre></div>
<h3 id="3-performance-optimization">3. Performance Optimization<a class="headerlink" href="#3-performance-optimization" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">optimized_chain</span><span class="p">():</span>
    <span class="c1"># Use parallel processing for independent operations</span>
    <span class="n">extractor</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;data_extractor&quot;</span><span class="p">)</span>
    <span class="n">analyzer1</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;analyzer&quot;</span><span class="p">)</span>
    <span class="n">analyzer2</span> <span class="o">=</span> <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;reporter&quot;</span><span class="p">)</span>  <span class="c1"># Different analysis</span>

    <span class="c1"># Optimize: parallel analysis, then combine</span>
    <span class="n">optimized</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">extractor</span> <span class="o">&gt;&gt;</span>
        <span class="n">CF</span><span class="p">(</span><span class="n">PersonData</span><span class="p">)</span> <span class="o">&gt;&gt;</span>
        <span class="p">(</span><span class="n">analyzer1</span> <span class="o">+</span> <span class="n">analyzer2</span><span class="p">)</span> <span class="o">&gt;&gt;</span>  <span class="c1"># Parallel analysis</span>
        <span class="k">await</span> <span class="n">isaa</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s2">&quot;summarizer&quot;</span><span class="p">)</span>  <span class="c1"># Combine results</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">optimized</span>
</code></pre></div>
<h3 id="direckt-call-support">Direckt call Support<a class="headerlink" href="#direckt-call-support" title="Permanent link">&para;</a></h3>
<ul>
<li>chain(...) → ruft sofort run</li>
<li>await chain(...) → ruft automatisch a_run</li>
</ul>
<h2 id="chain-operators-reference">Chain Operators Reference<a class="headerlink" href="#chain-operators-reference" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Operator</th>
<th>Purpose</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&gt;&gt;</code></td>
<td>Sequential execution</td>
<td><code>agent1 &gt;&gt; agent2</code></td>
</tr>
<tr>
<td><code>+</code></td>
<td>Parallel execution</td>
<td><code>agent1 + agent2</code></td>
</tr>
<tr>
<td><code>&amp;</code></td>
<td>Parallel execution (alias)</td>
<td><code>agent1 &amp; agent2</code></td>
</tr>
<tr>
<td><code>%</code></td>
<td>False branch in conditional</td>
<td><code>condition &gt;&gt; true_branch % false_branch</code></td>
</tr>
<tr>
<td><code>\|</code></td>
<td>Error handling fallback</td>
<td><code>risky_agent \| safe_agent</code></td>
</tr>
<tr>
<td><code>-</code></td>
<td>Data extraction</td>
<td><code>CF(Model) - "field"</code></td>
</tr>
</tbody>
</table>
<h2 id="cf-chain-format-reference">CF (Chain Format) Reference<a class="headerlink" href="#cf-chain-format-reference" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Pattern</th>
<th>Purpose</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CF(Model)</code></td>
<td>Format to Pydantic model</td>
<td><code>CF(UserProfile)</code></td>
</tr>
<tr>
<td><code>CF(Model) - "field"</code></td>
<td>Extract single field</td>
<td><code>CF(User) - "name"</code></td>
</tr>
<tr>
<td><code>CF(Model) - ("f1", "f2")</code></td>
<td>Extract multiple fields</td>
<td><code>CF(User) - ("name", "age")</code></td>
</tr>
<tr>
<td><code>CF(Model) - "*"</code></td>
<td>Extract all fields</td>
<td><code>CF(User) - "*"</code></td>
</tr>
<tr>
<td><code>CF(Model) - "field[n]"</code></td>
<td>Auto-parallel extraction</td>
<td><code>CF(Tasks) - "tasks[n]"</code></td>
</tr>
</tbody>
</table>
<p>This documentation provides comprehensive guidance for using the ISAA Chain system to create sophisticated AI agent workflows with powerful orchestration capabilities.</p>












                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "search.highlight"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>